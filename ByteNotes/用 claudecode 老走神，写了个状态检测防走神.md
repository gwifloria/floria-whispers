今年6月开始，我尝试为 aiprogram 付费。

我尝试的软件顺序是 Copilot → GPT-5 → ClaudeCode（20 刀版本）（以下简称 CC）。  
目前长期为 ClaudeCode 付费——他在项目整体规划和编码能力上都强出一大截。尤其是有 Plan Mode 这种模式，让人和 CC 在编码前就能有一个大致思路，而不是随意写到哪算到哪。

但不论是任何 AI 还是人，在接到需求时都需要一个思考过程：先解读需求，再在自己脑中搜索解决办法，所以在他打工的过程中，我们可能“无事可做”。
很多人会说，等待时可以喝杯咖啡、上个厕所、做点别的事等。但人一天可能没有那么多“碎片”要处理；更何况在信息碎片化爆炸的时代，很多人会去刷社媒、回消息、逛淘宝。

或许像 deep thinking（深度思考）这样的事可以交给代码来辅助，但人仍然主导深度思考。我相信很多人，像我一样，会把代码丢到后台“去打工”，自己去做别的事。十分钟后突然拍脑袋：诶？我刚刚在干嘛？而 AI 软件可能早就工作完成了，我们却还沉浸在其他碎片化的事情里。十分钟可能并不长，但在频繁切换应用、刷这个网站、瞄那个页面、顺手看看终端的情况下，时间就这样被浪费掉了。

我们使用 AI 工具，本质上是为了提升效率（快速检索更多解决办法）、减少机械劳动（重复性、简单的代码修改），但这并不等于减少脑力思考。哪种方案更好？或许还是需要你自己判断。

早期使用 Clash 时，总有上下行数据不断刷新，让我很烦——好在它有开关可以关闭这个展示。所以我在想：或许 AI 编程工具也需要“适度打扰”我一下。在它空闲时提醒我：继续思考、让它开始工作、检阅它生成的代码或想法。

网上有很多弹出系统通知的，但是我又嫌这种通知太烦了……

于是我打算尝试监听 ClaudeCode 的进程，并把状态显示在导航栏。我把这个想法丢给 Claude，他推荐我用 SwiftBar（一款开源软件）来实现。

结合 ClaudeCode的 hooks 功能

当Hooks 触发UserSumbitPrompt或者PreToolUse："matcher": "Grep|Glob|Edit|MultiEdit|Write|Read|Bash|Task"时候

SwiftBar展示-》 processing

当Hooks 触发Hooks:Notification
SwiftBar展示-》⚠️

当Hooks 触发 Stop 后，展示💤，表示当前正处于闲置状态

不过我仍不确定是否有更好的监听方法。我在想：在 AI 时代，很多人反复钻研 AI 的过程中会遇到一个问题——最终正确的解决办法会被记录并发布到网上吗？还是直接进入下一个任务，忘掉刚刚踩过的坑？当越来越少的人愿意静下心来分享自己踩过的坑，AI 真能越来越聪明吗？


附上相关 md
# ClaudeCode 监控器

**告别窗口切换，专注心流**

是否经常在终端窗口间来回切换，只为查看 ClaudeCode 是否完成？是否因为"需要用户确认"的提示被埋在其他工作区而错过？是否在多个项目中使用 Claude，却不记得哪个在处理、哪个在等你？

  

**ClaudeCode 监控器解决了这个问题**，通过动画指示器将实时状态直接显示在 macOS 菜单栏中。


## 痛点

使用 ClaudeCode 时，你会面临持续的注意力碎片化：

### 🔄 窗口切换成本

每次查看状态都需要切换窗口或工作区，打断心流。你正在编辑器中写代码，却需要每隔几分钟跳转到终端查看 Claude 是否完成。

### ⚠️ 错过通知

ClaudeCode 提示需要用户确认，但你正在 Slack、浏览器或另一个终端标签页中。等你注意到时，已经浪费了宝贵的几分钟——或者忘记了自己在做什么。

### 🎯 多项目混乱

在 3 个不同项目中运行 Claude？祝你能记住哪个在处理、哪个需要输入、哪个在 10 分钟前就完成了。

### ⏳ 不确定的等待

Claude 还在思考吗？崩溃了吗？我现在应该检查还是再等一分钟？这种不确定性浪费时间和精力。


### 📊 状态盲区

在其他应用中工作时，你完全看不到 ClaudeCode 的状态。你要么检查太频繁（浪费时间），要么检查太少（错过提示）。

  

---

  

## 解决方案

  

ClaudeCode 监控器为你提供**一目了然的感知**，无需离开当前任务：

  

**之前：** 🖥️→🔍→⌨️→🖥️→🔍（频繁切换）

**之后：** 👀（瞥一眼菜单栏）→ ✅（继续工作）

  

### 可视化状态指示器

  

通过流畅的 **6 帧顺时针动画**实时观看 Claude 工作：

  

```

⠇ → ⠦ → ⠴ → ⠸ → ⠙ → ⠋ (处理中)

⚠️ (需要你的注意！)

✅ (已完成，等待查看)

💤 (等待你的下一个任务)

```

  

### 基于优先级的显示

  

菜单栏自动显示所有项目中**最紧急**的状态：

1. **⚠️ 需要注意**（最高优先级）- 放下一切，Claude 需要你

2. **⠋ 处理中** - Claude 正在工作，你可以专注其他事情

3. **✅ 已完成** - 准备好供你查看

4. **💤 空闲** - 等待你的下一个提示

  

### 多项目感知

  

点击菜单栏图标查看每个项目的详细状态：

```

项目：

⚠️ my-web-app (需要确认)

⠴ backend-api (处理中)

✅ docs-site (已完成)

💤 mobile-app (空闲)

```

  

---

  

## 使用场景

  

### 场景 1：并行开发

你正在重构 `project-a`，同时 Claude 在审查 `project-b` 并为 `project-c` 生成测试。瞥一眼菜单栏就能知道：

- `project-b` 审查完成 ✅

- `project-c` 仍在工作 ⠦

- `project-a` 还不需要关注 💤

  

**结果：**零次窗口切换。你可以先完成当前的思路，再去查看完成的工作。

  

### 场景 2：长时间运行任务

你让 Claude 分析一个大型代码库（5-10 分钟）。不必每 30 秒焦虑地检查一次，你可以：

1. 看到处理动画 ⠴

2. 切换到邮件/Slack

3. 当菜单栏显示 ⚠️ 时被拉回（Claude 有疑问）

  

**结果：**每个长任务回收 5-10 分钟的有效工作时间。

  

### 场景 3：高频交互

通过多次迭代与 Claude 构建功能。每个确认提示可能让你损失 30-60 秒的注意力延迟：

- 没有监控器：10 个提示 × 45 秒 = 7.5 分钟损失

- 有监控器：⚠️ 出现 → 立即响应 → 0 延迟

  

**结果：**交互延迟减少 50-80%。

  

---

  

## 功能特性

  

- 🔄 **实时状态跟踪** - 同时监控多个项目的 ClaudeCode 活动

→ *解决：窗口切换成本、状态盲区*

  

- ⚠️ **基于优先级的警报** - 需要注意的任务在菜单栏中闪烁（不可能错过）

→ *解决：错过通知*

  

- 🎯 **智能状态显示** - 自动显示所有会话中最紧急的状态

→ *解决：多项目混乱*

  

- ⠋ **动画处理指示器** - 精美的 6 帧顺时针动画显示 Claude 正在工作

→ *解决：不确定的等待*

  

- 📊 **多会话支持** - 独立跟踪无限个 ClaudeCode 会话及项目名称

→ *解决：多项目混乱*

  

- 🚀 **零性能影响** - 最小资源占用（< 5MB RAM），无干扰运行

→ *故障安全设计：监控错误永不影响 ClaudeCode*

  

- 🔧 **安全安装** - 智能合并现有 ClaudeCode 设置，自动备份

→ *永不破坏你的现有配置*

  

## 状态类型

  

| 优先级 | 图标 | 状态 | 描述 | 看到时的行动 |

|----------|------|--------|-------------|-------------------|

| 🔴 **P1** | ⚠️ | **需要注意** | 需要用户确认 | 放下手头工作——Claude 需要你！ |

| 🟡 **P2** | ⠇⠦⠴⠸⠙⠋ | **处理中** | Claude 正在积极工作 | 放松，喝杯咖啡，Claude 搞定了 |

| 🟢 **P3** | ✅ | **已完成** | 任务完成，准备查看 | 准备好时检查结果 |

| ⚪ **P4** | 💤 | **空闲** | 等待你的下一个提示 | Claude 已准备好接受你的下一个任务 |

| ⚫ **—** | 💤0 | **未激活** | 未检测到会话 | 在任意项目中启动 ClaudeCode |

  

### 处理动画

  

处理指示器使用每秒更新的流畅**顺时针旋转**：

  

每一帧保持一个"锚点"固定，同时移动两个点，创造出对眼睛友好的流畅圆周运动。

  

## 前置要求

  

- 具有菜单栏访问权限的 macOS

- 已安装并配置 [ClaudeCode](https://claude.ai/code)

- [Homebrew](https://brew.sh)（推荐用于自动安装）

  

将自动安装的依赖：

- [SwiftBar](https://github.com/swiftbar/SwiftBar) - 菜单栏插件系统

- `jq` - JSON 处理器

  

## 快速安装

  

```bash

# 克隆仓库

git clone <repository-url>

cd claude-monitor

  

# 运行安装脚本

./install.sh

```

  

安装程序将：

1. 检查并安装依赖（SwiftBar、jq）

2. 选择安装范围（全局或特定项目）

3. 备份现有的 ClaudeCode 配置

4. 配置状态监控的 hooks

5. 安装 SwiftBar 插件

6. 可选启动监控器

  

## 使用方法

  

### 启动监控器

  

```bash

~/.claude-monitor/scripts/swiftbar_manager.sh start

```

  

### 查看状态

  

点击菜单栏图标查看：

- 带计数的总体状态摘要

- 各个项目的状态

- 快速导航到项目目录

- 清理和刷新选项

  

### 管理监控器

  

```bash

# 停止监控

~/.claude-monitor/scripts/swiftbar_manager.sh stop

  

# 重启

~/.claude-monitor/scripts/swiftbar_manager.sh restart

  

# 检查状态

~/.claude-monitor/scripts/swiftbar_manager.sh status

```

  

## 工作原理

  

ClaudeCode 监控器与 ClaudeCode 的内置 hooks 系统无缝集成：

  

```

┌─────────────┐ ┌──────────────┐ ┌─────────────┐

│ ClaudeCode │ event │ Hook Bridge │ update │ Status │

│ (CLI) │────────>│ (转换器) │────────>│ Manager │

│ │ │ │ │ (JSON) │

└─────────────┘ └──────────────┘ └──────┬──────┘

│ read

▼

┌─────────────┐

│ SwiftBar │

│ 菜单栏 UI │

└─────────────┘

```

  

### 事件流程

  

**当你提交提示时：**

1. `UserPromptSubmit` hook 触发 → 更新状态为 **⠇ 处理中**

2. SwiftBar 每 1 秒读取状态 → 显示动画旋转器

3. Claude 完成 → `Stop` hook 触发 → 状态变为 **✅ 已完成**

4. 你开始新任务 → 状态返回 **💤 空闲**

  

**当 Claude 需要确认时：**

1. `Notification` hook 触发 → 状态跳转到 **⚠️ 需要注意**（最高优先级）

2. 菜单栏显示警告图标 → 不可能错过

3. 你响应 → Hook 更新状态 → 动画继续

  

### 配置的 Hooks

  

| Hook 事件 | 触发时机 | 状态更新 | 优先级 |

|------------|---------|---------------|----------|

| `UserPromptSubmit` | 你发送提示 | ⠋ **处理中** | P2 |

| `Notification` | Claude 需要确认 | ⚠️ **需要注意** | P1（最高） |

| `Stop` | Claude 完成整个响应 | ✅ **已完成** | P3 |

| `SessionStart` | 新的 ClaudeCode 会话 | 💤 **空闲** | P4 |

| `SessionEnd` | ClaudeCode 退出 | *（移除会话）* | — |

  

> **注意**：`SubagentStop` **有意不配置**。Sub-agent 完成并不意味着主任务完成——Claude 可能启动多个 sub-agents 或在之后继续处理。

  

### 数据存储

  

状态存储在 `~/.claude-monitor/sessions.json` 的 JSON 中：

```json

{

"a3a5596b": {

"project_name": "my-web-app",

"project_path": "/Users/you/projects/my-web-app",

"status": "processing",

"priority": 3,

"timestamp": 1706345678

}

}

```

  

每个会话通过项目路径的 MD5 哈希标识，确保跨 hook 调用的一致跟踪。

  

## 菜单栏显示逻辑

  

菜单栏显示所有活动会话中**优先级最高**的状态：

  

1. **⚠️ 2** - 2 个项目需要确认下一步

2. **⠁ 1** - 1 个项目处理中

3. **✅ 3** - 3 个项目已完成

4. **💤** - 所有项目空闲

5. **💤0** - 无活动会话

  

点击图标查看每个项目的详细状态。


## 卸载

  

完全移除 ClaudeCode 监控器：

  

```bash

./uninstall.sh

```

  

这将：

- 移除所有已安装的文件

- 从备份还原原始 ClaudeCode 配置

- 清理 SwiftBar 插件

- 移除运行时数据

  

## 配置

  

### 安装范围

  

**全局安装（推荐）**

- 系统范围监控所有 ClaudeCode 会话

- 使用 `~/.claude/settings.json`

- 跨所有项目工作

  

**项目特定安装**

- 仅监控特定项目中的 ClaudeCode

- 使用项目目录中的 `./.claude/settings.json`

- 每个项目需要单独设置

  

### 自定义

  

编辑配置文件以自定义行为：

  

```bash

# Status manager 设置

~/.claude-monitor/lib/status_manager.sh

  

# Hook 行为

~/.claude/hooks/update_status.sh

  

# 菜单栏显示

~/Library/Application Support/SwiftBar/claude_monitor.1s.sh

```

  

## 架构

  

```

┌─────────────────────┐

│ SwiftBar 菜单栏 │ (显示层)

└──────────┬──────────┘

│ 读取

▼

┌─────────────────────┐

│ Status Manager │ (数据层 - JSON 存储)

└──────────┬──────────┘

▲ 更新

│

┌─────────────────────┐

│ Hook Bridge │ (事件层)

└──────────┬──────────┘

▲ 触发

│

┌─────────────────────┐

│ ClaudeCode Hooks │ (事件源)

└─────────────────────┘

```

  


---


## 致谢

  

- 为 Anthropic 的 [ClaudeCode](https://claude.ai/code) 构建

- 使用 [SwiftBar](https://github.com/swiftbar/SwiftBar) 进行菜单栏集成

- 受到 AI 辅助开发中更好工作流感知需求的启发

  

---

  

**注意**：此工具设计为完全无干扰。如果监控系统发生任何错误，它们永远不会影响 ClaudeCode 的操作。监控器会优雅且安静地失败。