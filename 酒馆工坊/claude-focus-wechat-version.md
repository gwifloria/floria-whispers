# 用 Claude Code 写代码时，为什么容易出 bug？
## 一个你可能没有意识到的陷阱

---

## 问题

我最近遇到了一个有点尴尬的问题。

每次使用 Claude Code 时，特别是当 Claude 说"我需要做一个可能有风险的操作，请你批准一下"的时候，我就会看一眼就点击批准。然后，浏览器会自动切过来，我开始刷刷推特或者看看新闻……

10 分钟后，我回到终端，结果发现 Claude 的最后一个修改把代码改坏了。我明明看到了那条警告消息，但当时根本没仔细读。

后来，我又遇到了同样的问题，不是一次两次，而是好几次。

**我开始思考：真的是 Claude 的问题吗？还是我的问题？**

## 根本原因

其实，问题出在**那个暂停的瞬间**。

当 Claude Code 停下来等你批准时，它创造了一个"空白时刻"。在这个空白中，我们的注意力特别容易逃逸。因为什么呢？

想象两个选择：
- 选项 A：仔细阅读 Claude 的计划和警告（需要专注、需要思考）
- 选项 B：打开浏览器，刷一些不需要思考的内容（即时反馈、多巴胺刺激）

我们的大脑，在疲劳时，总是倾向于选择 B。

更糟糕的是，一旦你点击了"批准"按钮，你已经进入了"后悔模式"。如果出现了 bug，你就会陷入一个循环：
- 浪费时间修复 bug
- 消耗更多 token
- **最重要的是，你的工作节奏被打破了**——这就是我说的"势头断裂"

在心理学中，这种流畅的工作状态（心理学家叫它"心流"）一旦被打断，重新建立需要额外的认知成本。所以，一个本来 30 分钟能解决的问题，可能因为势头断裂而耗费 2 小时。

## 我的解决方案

所以我做了什么呢？**我让计算机帮我自动记录每一次与 Claude 的交互。**

我用 Claude Code 自己写了一个脚本，连接到 Claude Code 的"生命周期钩子"。什么意思？就是在关键时刻自动执行。

具体来说，这个脚本做两件事：

### 第一步：任务开始时
当你提交一个 prompt 给 Claude 时，脚本自动记录：
- 几点几分开始的
- 你的任务是什么
- 工作在哪个项目上
- 这个会话的 ID（用来追踪）

### 第二步：任务完成时
当 Claude 完成工作时，脚本自动：
- 从 Claude 的会话记录中提取它的最终总结
- 记录完成时间
- 保存整个交互的链接

**关键是：脚本自动为你生成了两份日志。**

一份是**时间轴**（"我今天干了什么"），一份是**项目轴**（"这个项目的完整历史"）。

为什么是两份？因为：
- **时间轴**帮你快速回顾一天的工作
- **项目轴**帮你在遇到奇怪的 bug 时，快速回溯"我之前对这个功能做了什么"

## 为什么这个方案有效

你可能想问：这不就是个记录工具吗？为什么就能解决"分心"的问题？

因为有个心理学效应叫**"即刻确认"**。当你知道自己的每个决定都会被系统化地记录下来，你会不自觉地更谨慎。

换句话说，这个脚本做的不是强行让你专注，而是改变了决策的成本。现在，快速点击"批准"的成本提高了——因为你知道，如果出了问题，所有的痕迹都在那里。

而且，这个系统给了你一个**长期反馈循环**。一周后，当你回顾日志时，会清楚地看到：哪些决定导致了后续的 bug？哪些 Claude 的建议其实值得信任？哪些需要更深思？

这种学习是深度的、长期的。

## 额外收获

做这个项目时，我有个有趣的发现。当我让 Claude 帮我改进这个脚本的代码时，它不仅完成了我的要求，还给了我很多设计上的改进建议。

**这让我意识到：工具能帮你什么，工具做不了什么。**

工具能自动记录，但工具改变不了你的专注力。最终，掌控专注力的，还是你自己。

## 实践建议

如果你也遇到了这个问题，这里有几个建议：

**第一个**：在任务执行时，让你的代码编辑器/终端始终可见。最好把它 Pin 在屏幕顶部，这样可以减少"上网冲浪"的物理摩擦力。

**第二个**：将工作分批。不要在一个下午同时处理 5 个项目。选择一个项目，深度工作 1-2 小时，然后休息。深度工作的质量，远比碎片化的时间更重要。

**第三个**：当 Claude 要求批准时，给自己 5 秒钟。在这 5 秒里，问自己："我真的理解 Claude 要做什么吗？"这个短暂的暂停，往往能救你一条命。

---

## 技术细节在哪？

这篇文章只讲了问题和解决方案的核心思想。如果你对脚本的**具体实现**感兴趣（比如它如何从 Claude 的会话记录中提取信息、如何设置过滤规则来去掉垃圾消息等），我在个人网站上写了一份详细的技术版本。

那个版本包括：
- 完整的工作流程图
- 事件触发的详细步骤
- Bash 脚本的核心代码
- 如何在你自己的项目中使用

**扫码访问完整版**（或者在浏览器中输入）：

> gwifloria.space/claude-focus

在网站上，你还能找到：
- 脚本的源代码（可直接使用）
- Obsidian 笔记模板
- 一些关于专注力和深度工作的其他思考

---

## 最后的话

使用 AI 写代码，不是让你放弃思考，而是让你可以更高效地思考。但前提是，你要掌控这个过程。

这篇文章，以及我那个脚本，都是在探索一个问题：**如何在 AI 时代，保持人的专注力？**

如果你有自己的想法或者经历，欢迎在下方留言。我特别想听听你在使用 Claude Code 时遇到的真实情况。

---

**推荐阅读**：
- 如果你对"心流"这个概念感兴趣，推荐 Csikszentmihalyi 的《心流》
- 关于如何在工作中保持专注，可以看 Cal Newport 的《深度工作》
- 关于如何高效学习，推荐 Anders Ericsson 的《刻意练习》

祝你的每一次 Claude Code 会话都顺利！

---

**完整版本已发布在个人网站，包含技术细节、流程图、完整代码和使用指南。**

👉 访问：gwifloria.space/claude-focus
